# Concepts
> Last update 07.02.2023

## Types of malware

- **Virus** are known to self-replicate and are also called _file infector_. Viruses survive by infecting and inserting themselves into other healthy files on the system. When executed, these infected healthy programs run, execute, and display the intended functionality, but can also execute the virus in the background.
- **Worm** is malware or a malware functionality that spreads and infects other computers, either via the network or some physical means like the USB.
- **Backdoor** is an unauthorized entry point by which an attacker can enter the victim’s system. For example, malware can create an open network port on the system which has shell access, that can be accessed by the attacker to gain entry into the system.
- **Trojan** is malware that masquerades as a legitimate software and is installed on the victim machine with the user’s full knowledge, but the user is not aware of its real malicious intentions.
- **Spyware** spies on and steals sensitive data from your system. The data targeted by spyware can be usernames, passwords, images, and documents.
- **Keylogger** is a kind of spyware that can log the user’s keystrokes and send the recorded keystrokes back to the attacker.
- **Botnet** is a robot-made network that comprises of multiple machines infected by malware. The malware that forms this bot network or botnet works together as a herd, accepting and acting on commands sent by an attacker from a central server. Botnets can carry out denial-of-service (DOS) attacks, send spam, and so forth.
- **Remote administration tool (RAT)** is malware or a malware feature that can give the hacker full control of your system. These tools are very similar to desktop sharing software usually used by administrators to access our systems for troubleshooting purposes.  The only difference being malware RATs are used by attackers to access our computers without any authorization.
- **Adware** is normally included with software downloads from third-party websites. Its main objective is to announce a product. 
- **Rootkit** is malware or a malware functionality combined with another piece of malware, whose aim is to hide its activity or that of another malware on the system. Rootkits mostly function by modifying system functions and data structures.
- **Banking malware** works by intercepting and modifying browser communication to capture information on banking transactions and credentials.
- **Ransomware** works by taking hostage of the data, files, and other system resources on the system, and demand the victim for ransom in return to release these resources.
- **Cryptominer** is rarely known to steal data from the victim’s machine, but they eat up system resources by mining cryptocurrencies.
- **Downloader** is malware that downloads other malware. Botnets work as downloaders and download malware upon receiving a command from the central server. These days most of the Microsoft Office file-based macro malware are downloaders, which downloads another piece of the bigger malware payload. Emotet is a popular malware that uses a Microsoft document-based macro downloader.
- **Spammers** send out spam emails from the victim’s machine. The spam may contain emails containing links to malicious sites. The malware may read contacts from email clients like Microsoft Outlook installed on the victim’s machine and send out emails to those contacts.
- **Exploit** is not malware but rather malicious code that is meant to take advantage of a vulnerability on the system and exploit it to take control of the vulnerable program and thereby the system. These days most exploits are responsible for downloading other malware.

## Malware attack life cycle
```mermaid
graph LR;
    Development-->Distribution-->Infection-->Post-infection;
```
### Development
Developing malware is like developing any other kind of software. In this sense, this step in malware life is, at the same time, another life cycle, that is to say, the software life cycle (Planning, Analysis, Design, Implementation, Maintenece). Some interesting stuff to take in mind:

- Malware is modular and sometimes a family usually share more than one module.
- Normally, modules are created by the same person. It means that the existence of similar modules in malware normally imply a single campaign or APT.
- Cryptography is implemented to protect malware from being decrypted, detected, and analyzed.
- Antipiracy and anti-reverse engineering techniques are implemented by malware authors to prevent malware researchers from analyzing and deobfuscating malware, making it difficult to write effective signatures to detect malware.
- In order to avoid antivirus, a malware developer use _polymorphic packers_ or _cryptors_ that can create many malware variants from a single piece of malware. Another practice is inserting useless code. This kind of malware technology forced the antivirus industry to develop next-­ generation antivirus, which can identify malware by looking into the _behavior_ rather than detect it by its static properties or hash only.

### Distribution
To deliver malware, attackers use a variety of delivery mechanisms. The following is a list of some of the methods.
1. Exploit kits
2. Email spam and malicious attachments
3. Advertisements
4. USB drives
5. Other social engineering techniques

### Infection
After the distribution of the malware, and after reaching the target, the malware needs to overcome many hurdles like

1. Antivirus software
2. Bugs. If the malware was coded incorrectly or has bugs, it might fail to infect the target successfully.
3. Lack of a suitable execution environment. Sometimes the malware does not find a suitable environment like the appropriate dependency files and libraries on the victim machine, which might result in failed execution or a crash. For example, malware written in Java cannot execute on a machine if Java virtual machine is not installed on it.

### Post-infection
After successful infection, the malware needs to carry out the objectives of the attacker.  It might try to contact its owner or the central server for upgrades or commands from the attacker, upload the victim’s information, and so forth. The actions might include stealing data, credentials, or personal information, and giving remote access to the attacker, and so on.

## Malware hunting
Malware hunting means to hunt for new malware infections in the wild and collect other information related to them so that the organization stays a step ahead in preventing infection if possible and, in the worst case, be ready for an infection breakout. Some common tools, resources and technics are:

1. Blogs, feeds and other shared sources like [MISP](https://www.misp-project.org/)
2. Honeypots
3. Web Crawlers
4. Dark Markets
5. Incident Response and Forensics reports
6. IoCs

## Terminology 

1. **Advanced Persisent Threat (APT) attacks**, also known as targeted attacks, are carried out on a particular country, organization, or high-­ profile individual.
2. **Tactics, Techniques, and Procedures (TTP)** is a description of techniques and steps carried out by attacker groups to carry out a cyberattack. The identification of TTP is useful to link attackers with APT attacks.
3. **Vulnerability** is a bug in software that can be exploited (see next definition)
4. **Exploits** are small pieces of programs that are meant to compromise a vulnerability in the software and take control of the system
5. **Shellcodes** are small pieces of code that are used inside exploits to carry out small tasks, which allows the attacker to take control of the system.
6. **Malvertising** is a mechanism of distributing malware to victims by using advertisements and advertising networks, having it carry ads and links to malicious websites and data.
7. **Spam** is unsolicited or irrelevant emails that are sent by cyberattackers to the victims, containing malware and other malicious links to malicious sites to collect victim information and to distribute malware.
8. **Fileless attack** (aka. _living off the land_ or _LOLbins_) is a type of malicious activity that uses native, legitimate tools built into a system to execute a cyber attack. Unlike traditional malware, fileless malware does not require an attacker to install any code on a target’s system, making it hard to detect. For more information you can read this [Microsoft article](https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/fileless-threats?view=o365-worldwide).
9. **Drive-by-download** is an unintentional and automated download of malware to a victim system.
10. **Endpoint Detection and Response (EDR)** is considered a next-generation antivirus that can detect malware not only based on traditional signatures but also by using other techniques, including the behavior of the malware.
11. **Intrusion detection system (IDS) and intrusion prevention system (IPS)** are _network security products_ to identify and stop the transfer of malicious traffic over a network.
12. **Sandboxe** is automated and isolated malware analysis solution that execute malware in a controlled manner and logs and observes its behavior for maliciousness. The most common example is [Cuckoo](https://cuckoosandbox.org/).
13. **Data Loss and Prevention (DLP)** is software that is meant to prevent the leak of sensitive data from an organization either unintentionally or intentionally both by employees and by malware infections on the system.
14. **Threat hunting** is the process of proactively looking out for threats in a network. Threat hunting involves looking into logs of security products and systems to find out possibilities of compromise of any systems on a network.
15. **Artifacts** are _traces_ left by attackers or malware on the victim machine during a cyber attack.
16. **Indicator of compromise (IOC)** is an artifact left on a system that shows that the system has been compromised.
17. **Indicators of attack (IOA)** focus on detecting the intent of what an attacker is trying to accomplish, regardless of the malware or exploit (IOCs) used in an attack. For example, you can see there are some strange network connections in the organization and you relate this traffic with the execution of a file. You do not know if that file contains a malware nor the type of malware it may contain (IOCs), but you know it is the root cause of the strange network traffic. You could use this indicators of attack in order to anticipate the attacker's following steps by consulting many different TTP's. IOA's are useful to detect or stop _in process attacks_ while IOC's are useful to prevent and detect attacks once they've _already happened_. 
18. **Payload** is the core component of the malware that implements the malicious functionality of the malware.
19. **Persistence** is a mechanism used by malware to survive reboots or re-logins.
20. **Code injection** is a technique used by malware to place malicious code into another legitimate running target process and then executing it from within the target process.
21. **Hooking** is a technique used by malware to alter the original functionality of the target process or the kernel by intercepting library and system API calls made and modifying the functionality of these intercepted API calls.
22. **Packer/cryptors** are programs used by malware authors to enclose malicious malware payloads inside another layer of code to hide the actual functionality of the malware. Packers compress and obfuscate the true payload of a malware sample.
22. **Lateral movement** is a mechanism by which malware can propagate from one machine to another within a network, searching for other systems/resources to infect.
23. **Command-and-control (C2\CnC\C&C)** is a system that is used as a command center by attackers to control and communicate with their malware and infected systems.
24. **The Onion Router (Tor)** is both a networking protocol and also a tool mostly used by attackers to maintain anonymous communication while carrying out attacks.
25. **Domain generation algorithms (DGA)** is an algorithm used by malware to generate a large number of random domain names to communicate with their CnC servers. Some of these generated domain names (usually just one) may be registered as CnC servers for a short duration of time. DGA is used by attackers to prevent IDS/IPS signatures from detecting and blocking CnC communication. It also provides resilience against CnC domain-name takedowns.
26. **Privilege escalation** is a technique used by malware and exploits to elevate privilege to access certain system resources that are otherwise inaccessible with non-admin privileges.
27. **Exfiltration** is a mechanism by which the malware or adversaries steal sensitive data from the victim machine and _export it out_ of the victim system to its attacker.
